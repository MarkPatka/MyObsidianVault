**_Топик_** — это логическое разделение категорий сообщений на группы. Например, события по статусам заказов, координат партнёров, маршрутных листов и так далее.
Ключевое слово здесь — **логическое**. Мы создаём топики для событий общей группы и стараемся не смешивать их друг с другом. Например, координаты партнёров не должны быть в том же топике, что и статусы заказов, а обновлённые статусы по заказам не стоит складывать вперемешку с обновлением регистраций пользователей. 

![[kafka-image-topics-2.png]]

Топик удобно представлять как лог — вы пишете событие в конец и не разрушаете при этом цепочку старых событий. Общая логика:

- Один продюсер может писать в один или несколько топиков 
- Один консумер может читать один или несколько топиков
- В один топик могут писать один или более продюсеров
- Из одного топика могут читать один или более консумеров 

Теоретически, нет никаких ограничений на число этих топиков, но практически это ограничено числом партиций.

События организуются и надежно хранятся в топиках. Сильно упрощая, топик похож на папку в файловой системе, а события — это файлы в этой папке. Пример названия топика — «платежи». Топики в Kafka всегда являются мульти-производительными и мульти-подписческими: ==топик может иметь ноль, одного или много производителей, которые записывают в него события, а также ноль, одного или многих потребителей, которые подписываются на эти события==.  

События в топике можно читать столько раз, сколько необходимо — в отличие от традиционных messaging-систем, ==события не удаляются после потребления==. Вместо этого вы определяете, как долго Kafka должна хранить ваши события, с помощью настройки конфигурации для каждого топика, после чего старые события удаляются. 
Автоматическое удаление данных происходит посегментно (segment timestamp expired -> to delete) по достижении установленного TTL (time-to-live). Таким образом сегменты париций удаляются целиком, а не отдельными сообщениями в них.
Производительность Kafka практически постоянна по отношению к объему данных, поэтому длительное хранение данных вполне допустимо.
  
![[kafka-image-topics.png]]

Структура брокера в файловой системе, включает в себя, топики, партиции и сообщения, хранящиеся в виде log-файлов, имеющих следующую структуру:
- .log (само сообщение в байтах в сжатом виде, его оффсет, позиция и временная метка от эпохи)
- .index (оффсет каждого сообщения и его позиция)
- .timeindex (временная метка, используемая при выборке сообщений за определенный промежуток времени)

![[kafka-image-topik-structure.png]]

Подобный файл называется сегментом, его объем по умолчанию равен 1ГБ. По достижении максимального объема, создается файл ...0000000_2.log, ...0000000_2.index, ...0000000_2.timeindex и запись уже продолжается в нем. Такие файлы называются 
"[[4.6. Segments (Сегменты)|Сегментами]]".